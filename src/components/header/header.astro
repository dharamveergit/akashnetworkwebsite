---
import { getCollection } from "astro:content";
import ScrollingHeader from "./ScrollingHeader";

const pathname = `/${Astro.url.pathname.split("/")[1]}`;

interface Props {
  disableSticky?: boolean;
}

const { disableSticky } = Astro.props;

const posts = (await getCollection("Blog"))
  .filter((post) => {
    // Filter out posts with archive set to true.
    return post.data.archive !== true;
  })
  .sort((a, b) => {
    const dateA = new Date(a.data.pubDate);
    const dateB = new Date(b.data.pubDate);

    // Sort in descending order (latest date first)
    return dateB.getTime() - dateA.getTime();
  });
---

<ScrollingHeader
  client:load
  disableSticky={disableSticky}
  posts={posts}
  pathname={pathname}
  pathname2={Astro.url.pathname}
/>
